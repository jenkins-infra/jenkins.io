---
layout: advisory
title: Jenkins Security Advisory 2022-05-17
kind: plugins
issues:
- id: SECURITY-359
  reporter: Jesse Glick, CloudBees, Inc.
  title: Sandbox bypass vulnerability through implicitly allowlisted platform Groovy
    files in PLUGIN_NAME
  cve: CVE-2022-30945
  cvss:
    severity: High
    vector: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
  description: |-
    PLUGIN_NAME allows pipelines to load Groovy source files.
    This is intended to be used to allow Global Shared Libraries to execute without sandbox protection.

    In PLUGIN_NAME 2689.v434009a_31b_f1 and earlier, any Groovy source files bundled with Jenkins core and plugins could be loaded this way and their methods executed.
    If a suitable Groovy source file is available on the classpath of Jenkins, sandbox protections can be bypassed.

    NOTE: The Jenkins security team has been unable to identify any Groovy source files in Jenkins core or plugins that would allow attackers to execute dangerous code.
    While the severity of this issue is declared as High due to the potential impact, successful exploitation is considered very unlikely.

    PLUGIN_NAME 2692.v76b_089ccd026 restricts which Groovy source files can be loaded in Pipelines.

    Groovy source files in public plugins intended to be executed in sandboxed pipelines have been identified and added to an allowlist.
    The new extension point `org.jenkinsci.plugins.workflow.cps.GroovySourceFileAllowlist` allows plugins to add specific Groovy source files to that allowlist if necessary, but creation of plugin-specific Pipeline DSLs is strongly discouraged.
  plugins:
  - name: workflow-cps
    previous: 2689.v434009a_31b_f1
    fixed: 2692.v76b_089ccd026
- id: SECURITY-2116
  title: CSRF vulnerability in PLUGIN_NAME
  cve: CVE-2022-30946
  cvss:
    severity: Medium
    vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N
  description: |-
    PLUGIN_NAME 1158.v7c1b_73a_69a_08 and earlier does not require POST requests for a form validation endpoint, resulting in a cross-site request forgery (CSRF) vulnerability.

    This vulnerability allows attackers to have Jenkins send an HTTP request to an attacker-specified webserver.

    This form validation method no longer sends HTTP requests in PLUGIN_NAME 1172.v35f6a_0b_8207e.
  plugins:
  - name: script-security
    previous: 1158.v7c1b_73a_69a_08
    fixed: 1172.v35f6a_0b_8207e
- id: SECURITY-2478
  reporter: Daniel Beck, CloudBees, Inc.
  title: Multiple SCM plugins can check out from the controller file system
  cve: CVE-2022-30947 (Git), CVE-2022-30948 (Mercurial), CVE-2022-30949 (REPO)
  cvss:
    severity: Low
    vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N
  description: |-
    SCMs support a number of different URL schemes, including local file system paths (e.g. using `file:` URLs).

    Historically in Jenkins, only agents checked out from SCM, and if multiple projects share the same agent, there is no expected isolation between builds besides using different workspaces unless overridden.
    Some Pipeline-related features check out SCMs from the Jenkins controller as well.

    This allows attackers able to configure pipelines to check out some SCM repositories stored on the Jenkins controller's file system using local paths as SCM URLs, obtaining limited information about other projects' SCM contents.
    The following Jenkins plugins are known to be affected:

    * https://plugins.jenkins.io/git/[Git] 4.11.1 and earlier
    * https://plugins.jenkins.io/mercurial/[Mercurial] 2.16 and earlier
    * https://plugins.jenkins.io/repo/[REPO] 1.14.0 and earlier

    Affected plugins have been updated to reject local file paths being checked out on the controller:

    * https://plugins.jenkins.io/git/[Git] 4.11.2
    * https://plugins.jenkins.io/mercurial/[Mercurial] 2.16.1
    * https://plugins.jenkins.io/repo/[REPO] 1.15.0
  plugins:
  - name: git
    previous: 4.11.1
    fixed: 4.11.2
  - name: mercurial
    previous: '2.16'
    fixed: 2.16.1
  - name: repo
    previous: 1.14.0
    fixed: 1.14.1
- id: SECURITY-2604
  reporter: Kalle Niemitalo, Procomp Solutions Oy
  title: Multiple vulnerabilities in Windows Remote Command library in PLUGIN_NAME
  cve: CVE-2022-30950 (buffer overflow), CVE-2022-30951 (access control)
  cvss:
    severity: Medium
    vector: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N
  description: |-
    PLUGIN_NAME 1.8 and earlier includes the Windows Remote Command library.
    It provides a general-purpose remote command execution capability that Jenkins uses to check if Java is available, and if not, to install it.

    This library has a buffer overflow vulnerability that may allow users able to connect to a named pipe to execute commands on the Windows agent machine.

    Additionally, while the processes are started as the user who connects to the named pipe, no access control takes place, potentially allowing users to start processes even if they're not allowed to log in.

    PLUGIN_NAME 1.8.1 no longer includes the Windows Remote Command library.
    A Java runtime is expected to be available on agent machines and PLUGIN_NAME 1.8.1 does not install a JDK automatically otherwise.

    NOTE: PLUGIN_NAME is the only Jenkins project deliverable the Jenkins project security team is aware of that includes the Windows Remote Command library.
  plugins:
  - name: windows-slaves
    previous: '1.8'
    fixed: 1.8.1
- id: SECURITY-714
  title: User-scoped credentials exposed to other users by PLUGIN_NAME
  cve: CVE-2022-30952
  cvss:
    severity: Medium
    vector: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N
  description: |-
    When pipelines are created using the pipeline creation wizard in Blue Ocean, the credentials used are stored in the per-user credentials store of the user creating the pipeline.
    To allow pipelines to use this credential to scan repositories and checkout from SCM, the Blue Ocean Credentials Provider allows pipelines to access a specific credential from the per-user credentials store in PLUGIN_NAME 1.25.3 and earlier.

    As a result, attackers with Job/Configure permission can rewrite job configurations in a way that lets them access and capture any attacker-specified credential from any user's private credentials store.

    PLUGIN_NAME 1.25.4 deprecates the Blue Ocean Credentials Provider and disables it by default.
    As a result, all jobs initially set up using the Blue Ocean pipeline creation wizard and configured to use the credential specified at that time will no longer be able to access the credential, resulting in failures to scan repositories, checkout from SCM, etc. unless the repository is public and can be accessed without credentials.

    NOTE: This also applies to newly created pipelines after PLUGIN_NAME has been updated to 1.25.4.

    Administrators should reconfigure affected pipelines to use a credential from the Jenkins credential store or a folder credential store.
    See https://cloudbees.com/r/blue-ocean-credentials-removal[this help page on cloudbees.com] to learn more.

    To re-enable the Blue Ocean Credentials Provider, set the Java system property `io.jenkins.blueocean.rest.impl.pipeline.credential.BlueOceanCredentialsProvider.enabled` to `true`.
    Doing so is discouraged, as that will restore the unsafe behavior.

    NOTE: While Credentials Plugin provides the _Configure Credential Providers_ UI to enable or disable certain credentials providers, enabling the Blue Ocean Credentials Provider there is not enough in PLUGIN_NAME 1.25.4.
    Both the UI and system property need to enable the Blue Ocean Credentials Provider.

    Administrators not immediately able to update Blue Ocean are advised to disable the Blue Ocean Credentials Provider through the UI at _Manage Jenkins Â» Configure Credential Providers_ and to reconfigure affected pipelines to use a credential from the Jenkins credential store or a folder credential store.
  plugins:
  - name: blueocean-pipeline-scm-api
    previous: 1.25.3
    fixed: 1.25.4
- id: SECURITY-2502
  reporter: Tanner Emek from Tinder Security Labs
  title: CSRF vulnerability and missing permission checks in PLUGIN_NAME
  cve: CVE-2022-30953 (CSRF), CVE-2022-30954 (permission check)
  cvss:
    severity: Medium
    vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
  description: |-
    PLUGIN_NAME 1.25.3 and earlier does not perform permission checks in several HTTP endpoints.

    This allows attackers with Overall/Read permission to send requests to an attacker-specified URL.

    Additionally, these endpoints do not require POST requests, resulting in a cross-site request forgery (CSRF) vulnerability.

    PLUGIN_NAME 1.25.4 requires POST requests and the appropriate permissions for the affected HTTP endpoints.
  plugins:
  - name: blueocean
    previous: 1.25.3
    fixed: 1.25.4
- id: SECURITY-2753
  reporter: Kevin Guerroudj, CloudBees, Inc.
  title: Missing permission check in PLUGIN_NAME allows enumerating credentials IDs
  cve: CVE-2022-30955
  cvss:
    severity: Medium
    vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
  description: |-
    PLUGIN_NAME 1.5.31 and earlier does not perform a permission check in an HTTP endpoint.

    This allows attackers with Overall/Read permission to enumerate credentials IDs of credentials stored in Jenkins.
    Those can be used as part of an attack to capture the credentials using another vulnerability.

    An enumeration of credentials IDs in PLUGIN_NAME 1.5.32 requires the appropriate permissions.
  plugins:
  - name: gitlab-plugin
    previous: 1.5.31
    fixed: 1.5.32
- id: SECURITY-2600
  reporter: Kevin Guerroudj, CloudBees, Inc.
  title: Stored XSS vulnerability in PLUGIN_NAME
  cve: CVE-2022-30956
  cvss:
    severity: High
    vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H
  description: |-
    PLUGIN_NAME 3.6.10 and earlier does not restrict URL schemes in Rundeck webhook submissions.

    This results in a stored cross-site scripting (XSS) vulnerability exploitable by attackers able to submit crafted Rundeck webhook payloads.

    PLUGIN_NAME 3.6.11 sanitizes URLs submitted in Rundeck webhook payloads.
  plugins:
  - name: rundeck
    previous: 3.6.10
    fixed: 3.6.11
- id: SECURITY-2315
  reporter: Wadeck Follonier, CloudBees, Inc.
  title: Missing permission check in PLUGIN_NAME allows enumerating credentials IDs
  cve: CVE-2022-30957
  cvss:
    severity: Medium
    vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
  description: |-
    PLUGIN_NAME 2.6.1 and earlier does not perform a permission check in an HTTP endpoint.

    This allows attackers with Overall/Read permission to enumerate credentials IDs of credentials stored in Jenkins.
    Those can be used as part of an attack to capture the credentials using another vulnerability.

    As of publication of this advisory, there is no fix. link:/security/plugins/#unresolved[Learn why we announce this.]
  plugins:
  - name: ssh
    previous: 2.6.1
- id: SECURITY-2093
  reporter: Long Nguyen, Viettel Cyber Security
  title: CSRF vulnerability and missing permission checks in PLUGIN_NAME allow capturing
    credentials
  cve: CVE-2022-30958 (CSRF), CVE-2022-30959 (permission check)
  cvss:
    severity: High
    vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N
  description: |-
    PLUGIN_NAME 2.6.1 and earlier does not perform a permission check in an HTTP endpoint.

    This allows attackers with Overall/Read permission to connect to an attacker-specified SSH server using attacker-specified credentials IDs obtained through another method, capturing credentials stored in Jenkins.

    Additionally, this endpoint does not require POST requests, resulting in a cross-site request forgery (CSRF) vulnerability.

    As of publication of this advisory, there is no fix. link:/security/plugins/#unresolved[Learn why we announce this.]
  plugins:
  - name: ssh
    previous: 2.6.1
- id: SECURITY-2717
  reporter: Kevin Guerroudj, CloudBees, Inc., Wadeck Follonier, CloudBees, Inc., and
    Daniel Beck, CloudBees, Inc.
  title: Stored XSS vulnerabilities in multiple plugins providing additional parameter
    types
  cve: CVE-2022-30960 (Application Detector), CVE-2022-30961 (Autocomplete Parameter),
    CVE-2022-30962 (Global Variable String Parameter), CVE-2022-30963 (JDK Parameter),
    CVE-2022-30964 (Multiselect parameter), CVE-2022-30965 (Promoted Builds (Simple)),
    CVE-2022-30966 (Random String Parameter), CVE-2022-30967 (Selection tasks), CVE-2022-30968
    (vboxwrapper)
  cvss:
    severity: High
    vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H
  description: |-
    Multiple plugins do not escape the name and description of the parameter types they provide:

    * Application Detector Plugin 1.0.8 and earlier (SECURITY-2732 / CVE-2022-30960)
    * Autocomplete Parameter Plugin 1.1 and earlier (SECURITY-2729 / CVE-2022-30961)
    * Global Variable String Parameter Plugin 1.2 and earlier (SECURITY-2715 / CVE-2022-30962)
    * JDK Parameter Plugin 1.0 and earlier (SECURITY-2713 / CVE-2022-30963)
    * Multiselect parameter Plugin 1.3 and earlier (SECURITY-2726 / CVE-2022-30964)
    * Promoted Builds (Simple) Plugin 1.9 and earlier (SECURITY-2720 / CVE-2022-30965)
    * Random String Parameter Plugin 1.0 and earlier (SECURITY-2722 / CVE-2022-30966)
    * Selection tasks Plugin 1.0 and earlier (SECURITY-2728 / CVE-2022-30967)
    * vboxwrapper Plugin 1.3 and earlier (SECURITY-2734 / CVE-2022-30968)

    This results in stored cross-site scripting (XSS) vulnerabilities exploitable by attackers with Item/Configure permission.

    Exploitation of these vulnerabilities requires that parameters are listed on another page, like the "Build With Parameters" and "Parameters" pages provided by Jenkins (core), and that those pages are not hardened to prevent exploitation.
    Jenkins (core) has prevented exploitation of vulnerabilities of this kind on the "Build With Parameters" and "Parameters" pages since 2.44 and LTS 2.32.2 as part of the link:/security/advisory/2017-02-01/#persisted-cross-site-scripting-vulnerability-in-parameter-names-and-descriptions[SECURITY-353 / CVE-2017-2601] fix.
    Additionally, several plugins have previously been updated to list parameters in a way that prevents exploitation by default, see link:/security/advisory/2022-04-12/#SECURITY-2617[SECURITY-2617 in the 2022-04-12 security advisory for a list].

    The following plugins have been updated to escape the name and description of the parameter types they provide in the versions specified:

    * Application Detector Plugin 1.0.9
    * Multiselect parameter Plugin 1.4

    As of publication of this advisory, there is no fix available for the following plugins:

    * Autocomplete Parameter Plugin 1.1 and earlier (SECURITY-2729 / CVE-2022-30961)
    * Global Variable String Parameter Plugin 1.2 and earlier (SECURITY-2715 / CVE-2022-30962)
    * JDK Parameter Plugin 1.0 and earlier (SECURITY-2713 / CVE-2022-30963)
    * Promoted Builds (Simple) Plugin 1.9 and earlier (SECURITY-2720 / CVE-2022-30965)
    * Random String Parameter Plugin 1.0 and earlier (SECURITY-2722 / CVE-2022-30966)
    * Selection tasks Plugin 1.0 and earlier (SECURITY-2728 / CVE-2022-30967)
    * vboxwrapper Plugin 1.3 and earlier (SECURITY-2734 / CVE-2022-30968)

    link:/security/plugins/#unresolved[Learn why we announce this.]
  plugins:
  - name: multiselect-parameter
    previous: '1.3'
    fixed: '1.4'
  - name: app-detector
    previous: 1.0.8
    fixed: 1.0.9
  - name: autocomplete-parameter
    title: Autocomplete Parameter
    previous: '1.1'
  - name: JDK_Parameter_Plugin
    previous: '1.0'
  - name: global-variable-string-parameter
    previous: '1.2'
  - name: promoted-builds-simple
    previous: '1.9'
  - name: random-string-parameter
    previous: '1.0'
  - name: selection-tasks-plugin
    previous: '1.0'
  - name: vboxwrapper
    previous: '1.3'
- id: SECURITY-2322
  reporter: Kevin Guerroudj, Justin Philip, Marc Heyries, Wadeck Follonier, CloudBees,
    Inc.
  title: CSRF vulnerability in PLUGIN_NAME results in RCE
  cve: CVE-2022-30969
  cvss:
    severity: High
    vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
  description: |-
    PLUGIN_NAME 1.1 and earlier does not require POST requests for a form validation endpoint executing a provided Groovy script, resulting in a cross-site request forgery (CSRF) vulnerability.

    This vulnerability allows attackers to execute arbitrary code without sandbox protection if the victim is an administrator.

    As of publication of this advisory, there is no fix. link:/security/plugins/#unresolved[Learn why we announce this.]
  plugins:
  - name: autocomplete-parameter
    title: Autocomplete Parameter
    previous: '1.1'
- id: SECURITY-2267
  reporter: Kevin Guerroudj
  title: Stored XSS vulnerability in PLUGIN_NAME
  cve: CVE-2022-30970
  cvss:
    severity: High
    vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H
  description: |-
    PLUGIN_NAME 1.1 and earlier references Dropdown Autocomplete parameter and Auto Complete String parameter names in an unsafe manner from Javascript embedded in view definitions.

    This results in a stored cross-site scripting (XSS) vulnerability exploitable by attackers with Item/Configure permission.

    NOTE: While this looks similar to SECURITY-2729, this is an independent problem and exploitable even on views rendering parameters that otherwise attempt to prevent XSS vulnerabilities in parameter names.

    As of publication of this advisory, there is no fix. link:/security/plugins/#unresolved[Learn why we announce this.]
  plugins:
  - name: autocomplete-parameter
    title: Autocomplete Parameter
    previous: '1.1'
- id: SECURITY-1969
  reporter: Daniel Beck, CloudBees, Inc.
  title: XXE vulnerability in PLUGIN_NAME
  cve: CVE-2022-30971 (XXE), CVE-2022-30972 (CSRF)
  cvss:
    severity: High
    vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N
  description: |-
    PLUGIN_NAME 1.0 and earlier does not configure its XML parser to prevent XML external entity (XXE) attacks.

    This allows attackers with Item/Configure permission to have Jenkins parse a crafted file that uses external entities for extraction of secrets from the Jenkins controller or server-side request forgery.

    Additionally, the HTTP endpoint calling the XML parser does not require POST requests, resulting in a cross-site request forgery (CSRF) vulnerability.

    As of publication of this advisory, there is no fix. link:/security/plugins/#unresolved[Learn why we announce this.]
  plugins:
  - name: storable-configs-plugin
    title: Storable Configs
    previous: '1.0'
