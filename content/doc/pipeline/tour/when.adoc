---
layout: documentation
title: Conditionally running stages
---
:email: jenkinsci-docs@googlegroups.com
:sectanchors:
:toc:
:imagesdir: /doc/book/resources
:hide-uri-scheme:

From time to time you may need to skip stages based on some condition.
 
The most common case of this would be to only run a stage on a certain branch, 
for example during deployment:
   
[pipeline]
----
// Declarative //
pipeline {
    agent any
    stages {
        stage('Build') {
            steps {
                echo 'Building'
            }
        }
        stage('Test') {
            steps {
                echo 'Testing'
            }
        }
        stage('Deploy') {
            when {
                branch 'production'
            }
            steps {
                echo 'Deploying'
            }
        }
    }
}
----
  
You can also use environment variables and other expressions. 
Read more link:/doc/book/pipeline/syntax#when[about the syntax here].

When a the criteria in the 'when' section is not satisfied, the stage is marked as 
skipped (it is not marked as a failure).

link:/doc/book[User Handbook],
or the
link:/node[Jenkins blog] for the latest events, tutorials, and updates.
