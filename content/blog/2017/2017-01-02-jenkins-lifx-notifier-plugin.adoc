---
layout: post
title: "Jenkins LIFX notifier plugin"
tags:
- plugins
- lifx
author: vgaidarji
---

[NOTE]
====
This is a link:http://vgaidarji.me/blog/2017/01/02/jenkins-lifx-notifier-plugin/[cross post] by link:https://github.com/vgaidarji[Veaceslav Gaidarji], open source developer and contributor to the Jenkins and Bitrise projects.
====

Some time ago I've encountered a link:http://www.lifx.com[LIFX] smart bulbs. These are the bulbs with a chip inside - 50% bulb, 50% chip. There're mobile applications for easy configuration and remote control of the bulb. Nothing special here, it simply works and is very convenient to have such bulbs in dormitory.

=== Brilliant idea time

[quote]
____
99% of ideas which come to our minds either were already implemented by someone else or they are useless.
____

And as it always happens, developer inside me generated an idea, which was implemented by someone else already.

The idea was: to connect a LIFX bulb to Jenkins server and update the color according to a job's state.

Before starting to work on such Jenkins plugin, I searched for similar projects on Google and the first links pointed me to existing link:https://wiki.jenkins-ci.org/display/JENKINS/LIFX+notifier+plugin[LIFX notifier plugin] and a link:https://www.cloudbees.com/blog/lifx-smart-lightbulb-build-notifier-plugin[blog post] from Michael Neale who created the plugin. Michael's post describes exactly what I had in mind.

At this point I had to 2 options:

* **forget** about building something new and just use the plugin
* **improve** existing plugin

First option is always easy and effortless, but second one is more challenging.

=== Improvement of existing plugin

Existing link:https://plugins.jenkins.io/lifx-notifier[LIFX notifier plugin] did its job really well and I was able to connect my bulb to Jenkins and test it. But it wasn't complete and configurable at all (no possibility to change the colors).

First, I read Jenkins contribution guidelines, which link:https://wiki.jenkins-ci.org/display/JENKINS/Hosting+Plugins#HostingPlugins-Requesthosting[encourage] developers to improve existing plugins (if any) and not create other versions of plugins with similar functionality. Then
I've contacted Michael Neale, plugin author, via email and kindly asked for the contributor access in github for existing plugin version. After short discussion about my plans on this plugin, Michael added me as a contributor to github link:https://github.com/jenkinsci/lifx-notifier-plugin[repo
] and wished me good luck. Thanks Michael :wink:

Everything I wanted to improve in LIFX notifier plugin is to add possibility to customize the colors (`in progress`, `build success` and `build failure`). This is not a hard task actually. link:https://wiki.jenkins-ci.org/display/JENKINS/Plugins[1000+] plugins were developed for Jenkins by the community. It means that I can do that as well. Good for me that I've used some plugins already which had similar UI which I planned to add to LIFX notifier. Here're some of them:

1. link:https://github.com/jenkinsci/hockeyapp-plugin[HockeyApp] plugin
2. link:https://github.com/jenkinsci/fabric-beta-publisher-plugin[Fabric Beta publisher] plugin
3. Different link:https://wiki.jenkins-ci.org/display/JENKINS/Plugins#Plugins-Buildnotifiers[Build notifiers] plugins

These plugins `+` Jenkins link:https://wiki.jenkins-ci.org/display/JENKINS/Plugin+tutorial[plugin development documentation] `+` link:http://commons.apache.org/proper/commons-jelly/[Jelly components] helped me to:

* "understand better Jenkins architecture"
* "how Jenkins plugins work in general"
* "how to create UI of the plugin"
* "how to subscribe to Jenkins job state changes using appropriate extension points".

In a few weeks I've finished plugin modifications and covered with unit tests its major parts. As result plugin obtained a UI configuration section in `Post-build Actions` which is self descriptive:

image::/images/post-images/2017-01-02/plugin-configuration.png[plugin configuration, role="center"]

Last step was to prepare new plugin version and publish it to the world. Jenkins link:https://wiki.jenkins-ci.org/display/JENKINS/Hosting+Plugins["Hosting plugins"] document describes step by step process of how to publish a plugin. **This includes many steps which should be respected very carefully.**

=== Demo

video::Zdtf8M5yCgM[youtube]

=== What I've learned

It was my first experience in Jenkins plugins development. I should say that **steep learning curve is high enough**, and sometimes is really hard to find answers on appearing questions. But in general it's all about `Java`, `XML`, `Maven` and **it's a lot of fun** developing Jenkins plugins.

Check link:https://wiki.jenkins-ci.org/display/JENKINS/LIFX+notifier+plugin[plugin wiki page] for more information.

---

**Bonus**: link:https://bitrise.io[bitrise.io] users, I've developed link:https://github.com/vgaidarji/steps-lifx-notifier[step LIFX notifier] for bitrise as well.
