---
layout: gsocproject
title: "GSoC 2018. Code Coverage API Plugin"
status: "Completed"
tags:
- gsoc2018
student: shenyu_zheng
mentors:
- "christ66"
- "supun94"
- "jeffpearce"
- "oleg_nenashev"
links:
  gitter: "jenkinsci_code-coverage-api-plugin:gitter.im"
  github: "jenkinsci/code-coverage-api-plugin"
---

=== Overview

There are a lot of plugins which currently implement code coverage, however, they all use similar config, charts, and content. So it will be much better if we can have an API plugin which does the most repeated work for those plugins and offers a unified APIs which can be consumed by other plugins and external tools.

=== Supported Tools
* Embedded tools
** JaCoCo
* Other plugins as an Extension of Code Coverage API plugin
** Cobertura (https://github.com/jenkinsci/cobertura-plugin[Cobertura Plugin])
** llvm-cov (https://github.com/jenkinsci/llvm-cov-plugin[llvm-cov Plugin])

=== Architecture

This API plugin will mainly do these things:

. Find coverage reports according to the userâ€™s config.
. Use adapters to convert reports into the our standard format.
. Parse standard format reports, and aggregate them.
. Show parsed result in a chart.

So, we can implement code coverage publishing by simply writing an adapter, and such adapter only needs to do one thing - convert a coverage report into the standard format. The implementation is based on extension points, so new adapters can be created in separate plugins. In order to simplify conversion for XML reports, there is also an abstraction layer which allows creating XSLT-based converters.

*architecture diagram*

image:/images/post-images/code-coverage-api/architecture.png[title="Code Coverage API Plugin Architecture" role="center"]


=== Features

* Modernized coverage chart
* Coverage trend
* Source code navigation
* Parallel pipeline support
* Reports combining
* Rest API
* Failed conditions and flexible threshold setting
* Other small features

You can see more details in our link:/blog/2018/08/17/code-coverage-api-plugin-1/[1.0 release blog post]

=== First Phase Summary

* Prototype based on Cobertura plugin data model.
* Integrate other Java code coverage tools.
* Health report support.
* Auto detect support.(https://issue-redirect.jenkins.io/issue/51366[JENKINS-51366])
* Pipeline support.(https://issue-redirect.jenkins.io/issue/51363[JENKINS-51363])
* Threshold support.(https://issue-redirect.jenkins.io/issue/51364[JENKINS-51364])
* Modernize report.(https://issue-redirect.jenkins.io/issue/51368[JENKINS-51386])
* Unit tests.(https://issue-redirect.jenkins.io/issue/51611[JENKINS-51611])

=== Second Phase Summary

* Add source code navigation(https://issue-redirect.jenkins.io/issue/51988[JENKINS-51988])
* Prototype integration between Code Coverage API and Cobertura plugin(https://issue-redirect.jenkins.io/issue/51424[JENKINS-51424])
* Offer REST API to retrieve the coverage reports in machine-readable format.(https://issue-redirect.jenkins.io/issue/51422[JENKINS-51422])
* Offer REST API to retrieve the coverage trends in machine-readable format.(https://issue-redirect.jenkins.io/issue/51423[JENKINS-51423])
* Move auto-detector coverage publishing logic to the extension point implementation.(https://issue-redirect.jenkins.io/issue/51737[JENKINS-51737])
* Refactoring the configuration page to make it more user-friendly.(https://issue-redirect.jenkins.io/issue/51927[JENKINS-51927])
* Add support of llvm-cov Report converter.(https://issue-redirect.jenkins.io/issue/51736[JENKINS-51736])

=== Third Phase Summary

* Supporting combining reports within a build(e.g. after parallel() execution in Pipeline). (https://issue-redirect.jenkins.io/issue/51926[JENKINS-51926])
* Make Code Coverage API plugin more generic. (https://issue-redirect.jenkins.io/issue/52839[JENKINS-52839])
* Migrate LLVM coverage out into new plugin (https://issue-redirect.jenkins.io/issue/52630[JENKINS-52630])
* Refactoring of the adopted code(https://issue-redirect.jenkins.io/issue/51733[JENKINS-51733])
* Change current REST API to the standard format.(https://issue-redirect.jenkins.io/issue/52628[JENKINS-52628])
* Bug fixing.
* Writing documentation.
* Releasing the plugin.

=== Future tasks
* Implement more coverage tools (https://issue-redirect.jenkins.io/issue/52467[JENKINS-52467], https://issue-redirect.jenkins.io/issue/51469[JENKINS-52469] and etc.)
* Make the UI extensible (https://issue-redirect.jenkins.io/issue/51738[JENKINS-51738])
* Improve performance (https://issue-redirect.jenkins.io/issue/52982[JENKINS-52982])

=== Phase 3 Presentation Slides
++++
<center>
<iframe src="https://docs.google.com/presentation/d/e/2PACX-1vThjuFZCChtXhHOKINDxuC4Sfbv0JtHDN9GqWZFe7DfmbEOPZOk-t8DYZJSDEMeMWFpLeTqOAZgj0pB/embed?start=false&loop=false&delayms=3000" frameborder="0" width="720" height="434" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true"></iframe>
</center>


++++

=== Phase 3 Presentation Video
++++
<center>
  <iframe width="720" height="434" src="https://www.youtube.com/embed/GGEtN4nbtng" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
</center>
++++

=== Useful Links

* link:https://docs.google.com/document/d/10ko6W07pIpRqgYcv2Eq6tZwSg1UUybzJ9AsMZszfiXA/edit#heading=h.jv1f2icy8a5j[Project Proposal]
* link:/blog/2018/06/13/code-coverage-api-plugin/[Introduction Blogpost]
* link:https://www.youtube.com/watch?v=qWHM8S0fzUw[Phase 1 Presentation Video]
* link:https://docs.google.com/presentation/d/141gvnLeNem-2SdiIEM4ZN-nzDmhVJUrUYv-r6a482R8/edit?usp=sharing[Phase 1 Presentation Slides]
* link:https://www.youtube.com/watch?v=tuTODhJOTBU[Phase 2 Presentation Video]
* link:https://docs.google.com/presentation/d/1pHe7qFwo1ej1YdIUUVriQK09rVasmGpHnmycHy7ikws/edit?usp=sharing[Phase 2 Presentation Slides]

